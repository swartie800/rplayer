!function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=function(){function i(e,r,n){t(this,i),this.config=r;var s=e.localization.advertising,a={admessage:s.admessage,podmessage:s.podmessage,cuetext:s.cuetext,loadingAd:s.loadingAd,skipMessage:s.skipmessage,skipText:s.skiptext,debug:!1,admessagedynamickey:/(\b)xx(s?\b)/g,loadVideoTimeout:15e3,requestTimeout:15e3,adBlockTimeout:4e3};this.setOptions(a),this.fwassetid=n.fwassetid||e.fwassetid,this.duration=n.duration||e.duration||0,this.adschedule=n.adschedule||null;var o=n.freewheel||{},l=this.config.freewheel||{};this.profileid=o.profileid||l.profileid,this.sectionid=o.sectionid||l.sectionid,this.networkid=o.networkid||l.networkid,this.serverid=o.serverid||l.serverid,this.custom=o.custom||l.custom||{}}return r(i,[{key:"getSchedule",value:function(){var e=this.config;return this.adschedule||e.tag||e.schedule||e.ad}},{key:"getAdRules",value:function(){var e=this.config.rules||{},t=parseInt(e.frequency,10);return{startOn:e.startOn||1,frequency:isNaN(t)?1:t}}},{key:"setOptions",value:function(t){var i=this;Object.keys(t).forEach((function(r){var n=i.config[r]||i.config[r.toLowerCase()],s=t[r],a=e(s);if(void 0!==n){if("boolean"!==a&&"number"!==a||(n=function(e){if("true"===e)return!0;if("false"===e)return!1;var t=parseFloat(e);return isNaN(t)?e:t}(n)),e(n)!==a)throw new Error("invalid parameter: "+r+" should be a "+a);i[r]=n}else i[r]=s})),this.admessagedynamic=t.admessage}}]),i}(),a=null;function o(e,t){if(a)return a;if(window.tv&&tv.freewheel)return a=Promise.resolve();var i=document.location.protocol,r="file:"===i||"https:"===i?"https://mssl.fwmrm.net/libs/adm/6.43.0/AdManager.js":"http://adm.fwmrm.net/libs/adm/6.43.0/AdManager.js",n=new e.scriptloader(t||r);return a=n.load().then((function(){}))}var l={};var d=function(){function e(i,r){t(this,e),i.extend(this,r),this.isMuted=!1,this.vol=0,this.freewheelProxy=null}return r(e,[{key:"setProxy",value:function(e){this.freewheelProxy=e,this.mute(this.isMuted)}},{key:"attachMedia",value:function(){}},{key:"detachMedia",value:function(){}},{key:"mute",value:function(e){this.isMuted=e,this.freewheelProxy&&this.freewheelProxy.setAdVolume(this.isMuted?0:this.vol)}},{key:"volume",value:function(e){this.vol=e/100,this.freewheelProxy&&this.freewheelProxy.setAdVolume(this.vol)}},{key:"setFullscreen",value:function(e){if(this.video){if(e)try{var t=this.video.webkitEnterFullscreen;t&&t.apply(this.video)}catch(e){return!1}else{var i=this.video.webkitExitFullscreen;i&&i.apply(this.video)}return!!e}}}]),e}();function u(e,t,i){if(!e)return e;for(var r,n,s,a,o=t.getPlaylistItem(),l=e.replace("__random-number__",Math.random()*Math.pow(10,18)).replace("__timestamp__",(new Date).getTime()).replace("__page-url__",encodeURIComponent(window.location.href)).replace("__referrer__",encodeURIComponent(document.referrer)).replace("__player-height__",t.getHeight()).replace("__player-width__",t.getWidth()).replace("__item-duration__",(n=t.getDuration(),s=3,a=Math.pow(10,s),Math.round(n*a)/a)).replace("__domain__",encodeURIComponent((r=window.location.href.match(new RegExp(/^[^/]*:\/\/\/?([^/]*)/)))&&r.length>1?r[1]:"")),d=(l=i.companiondiv&&i.companiondiv.id?l.replace("__companion-div__",i.companiondiv.id):l.replace("__companion-div__","")).match(new RegExp(/__item-[a-z 0-9 A-Z]*__/g)),u=0;d&&u<d.length;u++){var h=d[u],c=h.substring(7,h.length-2);if(o.hasOwnProperty(c)&&t._.isString(o[c])){var f=o[c];f.length>1e3&&(f=f.substring(0,1e3)),l=l.replace(h,encodeURIComponent(f))}else l=l.replace(h,"")}return l}function h(e,t,i){if("start"===e||"0%"===e)return"pre";if("end"===e||"100%"===e)return"post";if("pre"===e||"post"===e||i.indexOf(e,"%")>-1)return e;var r=t.seconds(e);return!!i.isNumber(r)&&r}function c(e,t,i){var r,n,s,a,o,l=h(e,t,i);return l||(l="pre"),i.isNumber(l)&&(r=parseInt(1e3*l,10),n=Math.floor(r)%1e3,s=Math.floor(r/1e3)%60,a=Math.floor(r/6e4)%60,l=(o=(o=Math.floor(r/36e5)%24)<10?"0"+o:o)+":"+(a=a<10?"0"+a:a)+":"+(s=s<10?"0"+s:s)+"."+(n=("000"+n).slice(-3))),l}var f=function(){function e(i,r){t(this,e),this.player=i,this.options=r}return r(e,[{key:"getTagMap",value:function(e){var t=this,i=this.player,r=i.utils,n={};return r.foreach(function(e,t,i){var r={};return t.foreach(e,(function(e,n){var s={},a=n;n.ad&&(a=n.ad),s.offset=c(a.offset||a.position||n.offset||"",t,i),s.tag=a.tag,a.customadunitname&&(s.customadunitname=a.customadunitname),s.type=a.type||n.type||"linear,nonlinear",void 0!==a.skipoffset&&(s.skipoffset=a.skipoffset),r[e]=s})),r}(e,r,i._),(function(e,s){var a=h(s.offset,r,i._);if(i._.isString(a)&&(a=parseFloat(a.replace("pre","0").replace("post","-1"))),i._.isNumber(a)){var o={tagName:u(s.tag,i,t.options),type:s.type};void 0!==s.skipoffset&&(o.skipoffset=s.skipoffset),s.customadunitname&&(o.customAdUnitName=s.customadunitname),n[a]=o}})),n}}]),e}(),p={},v=function(){function e(i,r,n){t(this,e),this.responsePromise=null,this.streamType=n,this.adsManager=new tv.freewheel.SDK.AdManager,this.adsManager.setNetwork(r.networkid),this.adsManager.setServer(r.serverid),this.options=r||{},this.version=i,this.schedule=null,this.tagMap={},this._fwassetid=null,this._fwduration=0}return r(e,[{key:"open",value:function(e,t){var i=this,r=this.options;if(this.currentAdContext)throw new Error("Request already made");var n=r.getSchedule();if(!n)return this.responsePromise=Promise.reject(),this.responsePromise;p[r.sectionid]||(p[r.sectionid]=Math.floor(2147483648*Math.random()));var s=p[r.sectionid];this.currentAdContext=this.adsManager.newContext(),this.currentAdContext.setProfile(r.profileid);var a=r.freewheel?r.freewheel.sfid:null;if(this.currentAdContext.setSiteSection(r.sectionid,null,s,null,a),this._fwassetid=r.fwassetid,this._fwduration=r.duration,this.schedule=n,this.responsePromise=new Promise((function(e,t){i.currentAdContext.addEventListener(tv.freewheel.SDK.EVENT_REQUEST_COMPLETE,e),i.currentAdContext.addEventListener(tv.freewheel.SDK.EVENT_ERROR,t)})),"string"==typeof n)this.currentAdContext.addTemporalSlot(n,tv.freewheel.SDK.ADUNIT_PREROLL,0);else for(var o=new f(e,t),l=this.tagMap=o.getTagMap(n),d=Object.keys(l),u=0;u<d.length;u++){var h=parseFloat(d[u]),c=l[h].tagName,v=l[h].customAdUnitName,m=null;if("overlay"===l[h].type){if(-1===h)continue;m=tv.freewheel.SDK.ADUNIT_OVERLAY}if(!m)switch(h){case 0:m=v||tv.freewheel.SDK.ADUNIT_PREROLL;break;case-1:m=v||tv.freewheel.SDK.ADUNIT_POSTROLL,h=r.duration||1;break;default:m=v||tv.freewheel.SDK.ADUNIT_MIDROLL}this.currentAdContext.addTemporalSlot(c,m,h)}var g=r.custom,y=!1;for(var E in g)if(Object.prototype.hasOwnProperty.call(g,E)){var w=g[E];"string"!=typeof w&&(w=w.toString()),y||(this.currentAdContext._adRequest._keyValues.push(""),y=!0),"_fw_gdpr"===E?this.adsManager._fwGDPR=g[E]:"_fw_gdpr_consent"===E?this.adsManager._fwGDPRConsent=g[E]:this.currentAdContext.addKeyValue(E,g[E])}return this.responsePromise}},{key:"requestAds",value:function(e){var t=e.getConfig(),i=tv.freewheel.SDK.VIDEO_ASSET_AUTO_PLAY_TYPE_NONE;t.autostart&&(i=t.playOnViewable?tv.freewheel.SDK.VIDEO_ASSET_AUTO_PLAY_TYPE_ATTENDED:tv.freewheel.SDK.VIDEO_ASSET_AUTO_PLAY_TYPE_UNATTENDED);var r=Math.floor(2147483648*Math.random()),n=this.options.freewheel?this.options.freewheel.afid:null;"LIVE"===t.streamType||this.streamType&&"LIVE"===this.streamType.toUpperCase()?(this.currentAdContext.setVideoAsset(this._fwassetid,this._fwduration,null,null,i,r,null,n,tv.freewheel.SDK.VIDEO_ASSET_DURATION_TYPE_VARIABLE),this.currentAdContext.setRequestMode(tv.freewheel.SDK.REQUEST_MODE_LIVE)):this.currentAdContext.setVideoAsset(this._fwassetid,this._fwduration,null,null,i,r,null,n);var s=Math.floor(t.bandwidthEstimate/1e3);this.currentAdContext.setParameter(tv.freewheel.SDK.PARAMETER_DESIRED_BITRATE,s,tv.freewheel.SDK.PARAMETER_LEVEL_OVERRIDE),this.currentAdContext.setParameter(tv.freewheel.SDK.PARAMETER_EXTENSION_CONTENT_VIDEO_ENABLED,!1,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL);var a=e.getContainer(),o=a.querySelector(".jw-wrapper");o.id="".concat(a.id,"-jw-wrapper"),this.currentAdContext.registerVideoDisplayBase(o.id),this.currentAdContext.submitRequest()}},{key:"destroy",value:function(){}}]),e}();function m(e,t){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=(n(i={},tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL,"pre"),n(i,tv.freewheel.SDK.TIME_POSITION_CLASS_MIDROLL,"mid"),n(i,tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL,"post"),n(i,tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY,"overlay"),n(i,tv.freewheel.SDK.TIME_POSITION_CLASS_DISPLAY,"display"),i);return{type:e,client:"freewheel",adposition:s[r]||g(t),viewable:t.getViewable()}}function g(e){return e.isBeforePlay()||0===e.getPosition()?"pre":e.isBeforeComplete()||e.getPosition()===e.getDuration()?"post":"mid"}var y=function(){function e(i,r,n,s,a){var o=this;t(this,e),n.utils.extend(this,n.Events),this.item=i,this.options=r,this.streamType=a,this.player=n,this.utils=n.utils,this.style=n.utils.style,this.environment=n.getEnvironment(),this.instreamProvider=s,this.initAdsManagerPromise=null,this.adsLoadedPromise=null,this.blockingInstreamPlayer=null,this.video=null,this.timeoutAdStart=-1,this.timeoutAdLoad=-1,this.adBlockTimeout=-1,this.progressIntervalId=-1,this.nonlinearContainerId=null,this.slots={prerolls:[],midrolls:[],postrolls:[]},this.playedMidrollIndex=[],this.mobileEventListeners={play:function(){return o.adResume({reason:o.reason||"interaction"})},beginFullscreen:function(e){return o.startFullscreen(e)},endFullscreen:function(e){return o.endFullscreen(e)}},this.reason=null,this.playerEventListeners={"idle play pause beforeComplete":this.setVideoState},this.addPlayerListeners(),this._qoe=new n.utils.Timer}return r(e,[{key:"init",value:function(){var e=this;this.initAdsManagerPromise=o().then((function(){return e.destroyed()?null:(e.adsLoaderManager=new v(e.player.version,e.options,e.streamType),e.player.trigger("adManager",{adManager:e.adsLoaderManager.adsManager}),e.player.trigger("adsManager",{adsManager:e.adsLoaderManager.adsManager}),e.adsLoaderManager)})).catch((function(t){return e.asyncError(t)})),this.adsLoadedPromise=this.initAdsManagerPromise.then((function(){return e.adsLoaderManager.open(e.player,e.options)})).then((function(t){if(e.destroyed())return null;if(t.success){e.trigger("adRequest",{client:"freewheel",networkid:t.response.networkId});var i=e.adsLoaderManager.currentAdContext;e.instreamProvider.setProxy(i);for(var r=i.getTemporalSlots(),n=[],s=0;s<r.length;s++){var a=r[s];switch(a.getTimePositionClass()){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:e.slots.prerolls.push(a);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY:e.slots.midrolls.push(a);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_MIDROLL:e.slots.midrolls.push(a),n.push({begin:a.getTimePosition(),text:e.options.cuetext,cueType:"ads"});break;case tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL:e.slots.postrolls.push(a)}}e.player.addCues(n),e.registerEvents(i),i.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_DISPLAY_CONTROLS_WHEN_PAUSE,!1,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL)}else e.asyncError(t);return e.slots.prerolls.length&&e.utils.addClass(e.player.getContainer(),"jw-flag-ads-freewheel"),t})).catch((function(t){return e.asyncError(t)}))}},{key:"registerEvents",value:function(e){var t=this;e.addEventListener(tv.freewheel.SDK.EVENT_SLOT_STARTED,(function(e){return t.adStarted(e)})),e.addEventListener(tv.freewheel.SDK.EVENT_SLOT_ENDED,(function(e){return t.adSlotComplete(e)})),e.addEventListener(tv.freewheel.SDK.EVENT_AD,(function(e){return t.allAdEvent(e)}))}},{key:"startFullscreen",value:function(e){this.sendFullscreenEvent(e,!0)}},{key:"endFullscreen",value:function(e){this.sendFullscreenEvent(e,!1)}},{key:"sendFullscreenEvent",value:function(e,t){this.blockingInstreamPlayer&&this.blockingInstreamPlayer.trigger("fullscreenchange",{target:e.target,jwstate:t})}},{key:"adErrorEventObject",value:function(e){if(60003===e.adErrorCode)return e;var t=e.adInstance,i=tv?e[tv.freewheel.SDK.INFO_KEY_ERROR_INFO]:"FreeWheel SDK unavailable";return{id:t?t.getAdId():void 0,client:"freewheel",message:"Ad Error: "+i,code:e[tv.freewheel.SDK.INFO_KEY_ERROR_CODE],module:e[tv.freewheel.SDK.INFO_KEY_ERROR_MODULE]}}},{key:"adEventObject",value:function(e){var t=this.currentSlot,i={client:"freewheel"};if(t&&(i.tag=t.getCustomId()),!e&&t&&(e=t.getCurrentAdInstance()),!e)return i;var r=t.getTimePositionClass(),n="OVERLAY"===r,s=e.getActiveCreativeRendition();i.freewheel={ad:{adId:e.getAdId()}},i.adposition=r.toLowerCase().replace("roll",""),i.id=e.getAdId(),i.linear=n?"nonlinear":"linear",i.creativetype="static",i.viewable=this.player.getViewable(),n||(i.creativetype="VPAID"===s.getCreativeApi()?"vpaid-js":s.getContentType());var a=t.getAdCount();return a>1&&(i.sequence=t.getAdInstances().indexOf(e)+1,i.podcount=a),e.skipoffset&&(i.skipoffset=e.skipoffset),i}},{key:"allAdEvent",value:function(e){var t=e.subType;switch(t){case tv.freewheel.SDK.EVENT_AD_IMPRESSION:this.adImpression.call(this,e);break;case tv.freewheel.SDK.EVENT_AD_IMPRESSION_END:this.setTimeoutAdStart.call(this,e);break;case tv.freewheel.SDK.EVENT_AD_PAUSE:case tv.freewheel.SDK.EVENT_AD_RESUME:var i=e.adInstance;null===this.reason&&"VPAID"===i.getActiveCreativeRendition().getCreativeApi()&&(this.reason="external");var r=t===tv.freewheel.SDK.EVENT_AD_PAUSE?"paused":"playing";this.setState(i,r);break;case tv.freewheel.SDK.EVENT_AD_COMPLETE:this.adComplete.call(this,e);break;case tv.freewheel.SDK.EVENT_AD_CLICK:this.adClick.call(this,e);break;case tv.freewheel.SDK.EVENT_ERROR:this.adError.call(this,e);break;case tv.freewheel.SDK.EVENT_AD_AUTO_PLAY_BLOCKED:this.pause.call(this,{reason:"autostart"}),this.currentSlot&&this.instreamProvider.trigger("playAttemptFailed")}}},{key:"setupSkipButton",value:function(e){var t=this.options.config.skipoffset,i="POSTROLL"===e.slot.getTimePositionClass()?-1:e.slot.getTimePosition(),r=this.adsLoaderManager.tagMap;if(r){var n=r[i];n&&void 0!==n.skipoffset&&(t=n.skipoffset)}void 0!==t&&this.blockingInstreamPlayer&&(this.blockingInstreamPlayer.off("adSkipped",this.adSkip,this),e.adInstance.skipoffset=t,this.blockingInstreamPlayer.setupSkipButton(t,this.options,this.utils.noop),this.blockingInstreamPlayer.on("adSkipped",this.adSkip,this))}},{key:"adStarted",value:function(e){var t=this,i=e.slot.getTimePositionClass();i!==tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY&&(this.player.trigger("adBreakStart",m("adBreakStart",this.player,i)),this.blockingInstreamPlayer.on("destroyed",(function(){t.player.trigger("adBreakEnd",m("adBreakEnd",t.player,i))})))}},{key:"adImpression",value:function(e){clearTimeout(this.timeoutAdLoad),clearTimeout(this.timeoutAdStart),clearTimeout(this.adBlockTimeout);var t=e.adInstance,i=this.adEventObject(t),r="VPAID"===t.getActiveCreativeRendition().getCreativeApi();if(this.utils.removeClass(this.player.getContainer(),"jw-freewheel-before-impression"),this.utils.toggleClass(this.player.getContainer(),"jw-flag-ads-vpaid",r),this.isPreroll(i)&&(this._qoe.tick("adImpression"),i.timeLoading=this._qoe.between("adLoading","adImpression")),this.updateAdPosition(t),this.progressInterval(this.currentSlot),this.setupSkipButton(e),this.setupNonlinearContainer(),this.resize(),this.trigger("adImpression",i),r&&this.trigger("adStarted",i),t.getCompanionAdInstances().length){var n=this.utils.extend({},i);n.companions=t.getCompanionAdInstances(),this.trigger("adCompanions",n)}this.setState(e.adInstance,"playing")}},{key:"setTimeoutAdStart",value:function(){var e=this;clearTimeout(this.timeoutAdLoad),clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout((function(){if(!e.destroyed()){var t=e.adEventObject();t.message="Ad Error: Creative timeout",e.trigger("adError",t),e.currentSlot.skipCurrentAd()}}),this.options.loadVideoTimeout)}},{key:"setAdBlockTimeout",value:function(){var e=this;this.player.getAdBlock()&&(clearTimeout(this.adBlockTimeout),this.adBlockTimeout=setTimeout((function(){e.destroyed()||e.adError({id:void 0,client:"freewheel",message:"Ad playback blocked by an ad blocker",code:900,adErrorCode:60003})}),this.options.adBlockTimeout))}},{key:"setVideoState",value:function(e){var t=e.type;if(this.adsLoaderManager&&this.adsLoaderManager.currentAdContext){var i={idle:tv.freewheel.SDK.VIDEO_STATE_STOPPED,play:tv.freewheel.SDK.VIDEO_STATE_PLAYING,pause:tv.freewheel.SDK.VIDEO_STATE_PAUSED,beforeComplete:tv.freewheel.SDK.VIDEO_STATE_COMPLETED};this.adsLoaderManager.currentAdContext.setVideoState(i[t])}}},{key:"adResume",value:function(e){var t=e.reason;this.hasResumed||(this.reason=t,this.currentSlot.resume()),this.hasResumed=!1}},{key:"adSkip",value:function(){var e=this.currentSlot;e.getCurrentAdInstance()&&(clearInterval(this.progressIntervalId),this.trigger("adSkipped",this.adEventObject()),e.skipCurrentAd())}},{key:"stopAd",value:function(){var e=this.currentSlot;e&&(clearInterval(this.progressIntervalId),this.trigger("adSkipped",this.adEventObject()),e.stop())}},{key:"adComplete",value:function(e){clearInterval(this.progressIntervalId),this.trigger("adComplete",this.adEventObject(e.adInstance))}},{key:"adSlotComplete",value:function(e){var t=this,i=e.slot;i&&"POSTROLL"===i.getTimePositionClass()?setTimeout((function(){t.stopBlocking(),t.nonlinearContainerId=null,t.destroy()}),0):(this.stopBlocking(),this.nonlinearContainerId=null)}},{key:"adClick",value:function(e){this.trigger("adClick",this.adEventObject(e.adInstance)),this.pause({reason:"clickthrough"})}},{key:"adError",value:function(e){var t=this;this.options.debug&&console.error(e);var i=this.adErrorEventObject(e);900===i.code&&(this.timeoutAdStart=setTimeout((function(){return t.destroy()}),0));var r=e?e.adInstance:null;r&&this.isPreroll(this.adEventObject(r))&&(this._qoe.tick("adError"),i.timeLoading=this._qoe.between("adLoading","adError")),this.trigger("adError",i)}},{key:"updateAdPosition",value:function(e){this.instreamProvider&&this.instreamProvider.trigger("time",{position:Math.max(e.getPlayheadTime(),0),duration:e.getDuration()})}},{key:"prepareToPlayAd",value:function(e){if(!this.destroyed())if(this.blockingInstreamPlayer){var t=e?"":this.options.loadingAd;this.blockingInstreamPlayer.setText(t)}else this.startBlocking(e)}},{key:"addMobileListeners",value:function(){var e=this;Object.keys(this.mobileEventListeners).forEach((function(t){e.video.addEventListener(t,e.mobileEventListeners[t])}))}},{key:"removeMobileListeners",value:function(){var e=this;Object.keys(this.mobileEventListeners).forEach((function(t){e.video.removeEventListener(t,e.mobileEventListeners[t])}))}},{key:"addPlayerListeners",value:function(){this.player.on(this.playerEventListeners,this)}},{key:"removePlayerListeners",value:function(){this.player.off(this.playerEventListeners,this)}},{key:"startBlocking",value:function(e){var t=this;if(!this.blockingInstreamPlayer){this._qoe.tick("adLoading"),clearTimeout(this.timeoutAdLoad),clearTimeout(this.timeoutAdStart),clearTimeout(this.adBlockTimeout),this.timeoutAdLoad=setTimeout((function(){if(!t.destroyed()){t.currentSlot&&t.currentSlot.stop();var e=t.adEventObject();e.message="Ad Error: Request timeout",t.trigger("adError",e),t.stopBlocking()}}),this.options.requestTimeout),this.utils.addClass(this.player.getContainer(),"jw-flag-ads-freewheel"),this.blockingInstreamPlayer=this.player.createInstream().init(),this.video=this.instreamProvider.video=this.blockingInstreamPlayer.getMediaElement(),this.video.addEventListener("mousedown",E),this.video.addEventListener("pointerdown",E),this.player.getPip()&&this.player.requestPip(this.video);var i=e?"":this.options.loadingAd;this.blockingInstreamPlayer.setText(i),this.blockingInstreamPlayer.applyProviderListeners(this.instreamProvider),this.environment.OS.mobile&&(this.removeMobileListeners(),this.addMobileListeners())}}},{key:"stopBlocking",value:function(){this.destroyed()||(clearTimeout(this.timeoutAdLoad),clearTimeout(this.timeoutAdStart),clearTimeout(this.adBlockTimeout),this.utils.removeClass(this.player.getContainer(),["jw-flag-ads-vpaid","jw-flag-ads-freewheel","jw-freewheel-before-impression"]),this.environment.OS.mobile&&this.removeMobileListeners(),this.blockingInstreamPlayer&&(this.instreamProvider.off(),this.blockingInstreamPlayer.destroy(),this.blockingInstreamPlayer=null,this.video.removeEventListener("mousedown",E),this.video.removeEventListener("pointerdown",E),this.video=this.instreamProvider.video=null))}},{key:"setupNonlinearContainer",value:function(){if(this.nonlinearContainerId){var e=document.getElementById(this.nonlinearContainerId);this.utils.addClass(e,"jw-freewheel-nonlinear-container"),this.style(e,{top:"auto",height:"100%",width:"100%"})}}},{key:"beforePlay",value:function(e){var t=this;this.reason=e&&e.playReason?e.playReason:"external";var i=!this.slots.prerolls.length;this.startBlocking(i),this.utils.addClass(this.player.getContainer(),"jw-freewheel-before-impression"),this.initAdsManagerPromise.then((function(){t.setAdBlockTimeout(),t.adsLoaderManager.requestAds(t.player)})),this.adsLoadedPromise.then((function(e){!t.destroyed()&&e.success&&t.playNextAd(t.slots.prerolls)})).catch((function(e){return t.asyncError(e)}))}},{key:"playNextAd",value:function(e){if(e.length){var t=this.currentSlot=e.shift();if("OVERLAY"!==t.getTimePositionClass()){var i=!t.getAdCount();this.prepareToPlayAd(i),this.nonlinearContainerId=null}else this.utils.addClass(this.player.getContainer(),"jw-flag-ads-freewheel"),this.nonlinearContainerId="_fw_ad_container_html_"+this.currentSlot.getCustomId()+"_";this.setTimeoutAdStart(),t.play(),"MIDROLL"===t.getTimePositionClass()&&this.setVideoState({type:"pause"})}else this.stopBlocking()}},{key:"beforeComplete",value:function(){this.slots.postrolls.length&&this.playNextAd(this.slots.postrolls)}},{key:"time",value:function(e){if(this.slots.midrolls.length){var t=this.getNextMidRollIndex(e.position);if(t>=0){var i=[this.slots.midrolls[t]];this.playNextAd(i)}}}},{key:"progressInterval",value:function(e){var t=this;if(clearInterval(this.progressIntervalId),e){var i=e.getCurrentAdInstance(),r=e.getAdInstances().indexOf(i)+1,n=i.getDuration(),s=e.getAdCount(),a=-1,o=this.options.admessage||"",l=this.options.admessagedynamickey,d=this.options.podmessage||"",u=new RegExp("__AD_POD_CURRENT__","g"),h=new RegExp("__AD_POD_LENGTH__","g");this.progressIntervalId=setInterval((function(){var e=i.getPlayheadTime(),c=n-e;if(a!==c){if(a=c,t.blockingInstreamPlayer){var f=o.replace(l,"$1".concat(Math.round(c),"$2"));s>1&&(f=d.replace(u,r).replace(h,s)+"  "+f),t.blockingInstreamPlayer.setText(f)}if(n>0){var p=t.adEventObject(i);p.position=e,p.duration=n,t.trigger("adTime",p),t.updateAdPosition(i)}}}),250)}}},{key:"getNextMidRollIndex",value:function(e){var t=-1;if(this.playedMidrollIndex.length>=this.slots.midrolls.length)return t;for(var i=0;i<this.slots.midrolls.length;i++){if(!(this.slots.midrolls[i].getTimePosition()<=e))break;t=i}return this.playedMidrollIndex.indexOf(t)<0&&t>=0?(this.playedMidrollIndex.push(t),t):-1}},{key:"setState",value:function(e,t){if(this.currentSlot.getTimePositionClass()!==tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY){var i=this.adEventObject(e);if(i.newstate=t,null!==this.reason)i["playing"===t?"playReason":"pauseReason"]=this.reason,this.reason=null;this.instreamProvider.trigger("state",i)}}},{key:"asyncError",value:function(e){var t=this;this.destroyed()||(e&&this.adError(e),this.timeoutAdStart=setTimeout((function(){return t.destroy()}),0))}},{key:"pause",value:function(e){var t=e.reason;this.currentSlot&&!this.video.paused&&(this.reason=t||"external",this.currentSlot.pause())}},{key:"resume",value:function(e){var t=e.reason;this.currentSlot&&this.video.paused&&(this.reason=t||"external",this.currentSlot.resume(),this.hasResumed=!0)}},{key:"resize",value:function(e,t){var i=document.getElementById(this.nonlinearContainerId);if(i){var r=i.querySelector("iframe"),n=this.player.getSafeRegion(!0);this.style(r,{left:(n.width-r.offsetWidth)/2})}this.adsLoaderManager&&this.adsLoaderManager.currentAdContext&&e&&t&&this.adsLoaderManager.currentAdContext.resize(e,t)}},{key:"destroy",value:function(){clearInterval(this.progressIntervalId),this.off(),this.destroyed()||(this.removePlayerListeners(),this.currentSlot&&this.currentSlot.stop(),this.blockingInstreamPlayer&&(this.blockingInstreamPlayer.off(null,null,this),this.stopBlocking()),this.adsLoaderManager&&this.adsLoaderManager.destroy(),clearTimeout(this.timeoutAdLoad),clearTimeout(this.timeoutAdStart),clearTimeout(this.adBlockTimeout),this.nonlinearContainerId=null,this.item=null,this.options=null,this.player.off(null,null,this),this.player=null,this.instreamProvider.off(),this.instreamProvider.setProxy(null),this.instreamProvider=null,this.video=null,this.initAdsManagerPromise=null,this.adsLoadedPromise=null)}},{key:"destroyed",value:function(){return!this.item}},{key:"isPreroll",value:function(e){return"pre"===e.adposition&&(void 0===e.podcount||0===e.sequence)}}]),e}();function E(e){e.stopPropagation()}!function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");t.setAttribute("media","screen"),t.innerHTML=e,document.head.appendChild(t)}}(".jwplayer.jw-flag-ads-freewheel.jw-flag-floating .jw-wrapper,.jwplayer.jw-flag-ads-freewheel.jw-freewheel-before-impression .jw-media video{pointer-events:none}.jwplayer.jw-flag-ads-freewheel.jw-flag-touch.jwplayer.jw-flag-ads-freewheel.jw-state-paused .jw-display-icon-container{display:none}.jwplayer.jw-flag-ads-freewheel.jw-flag-user-inactive.jw-state-playing .jw-freewheel-nonlinear-container{bottom:.5em}.jwplayer.jw-flag-ads-freewheel .jw-freewheel-nonlinear-container{bottom:3.5em;pointer-events:none}.jwplayer.jw-flag-ads-freewheel .jw-freewheel-nonlinear-container iframe{pointer-events:all}.jwplayer.jw-flag-ads-freewheel.jw-flag-time-slider-above .jw-freewheel-nonlinear-container{bottom:66px}"),(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)("freewheel","8.1",(function(e,t){var i=this,r=e.utils,n=e.getConfig(),a=n.key,u=new d(r,e.Events),h=t.freewheel?t.freewheel.adManagerURL:null,c=0;o(r,h).then((function(){t.debug?tv.freewheel.SDK.setLogLevel(tv.freewheel.SDK.LOG_LEVEL_DEBUG):tv.freewheel.SDK.setLogLevel(tv.freewheel.SDK.LOG_LEVEL_QUIET)})).catch(r.noop);var f=null;function p(){f&&!f.destroyed()&&(f.destroy(),f=null)}function v(){p(),e.setCues([])}function m(i,r){var n=i.item,a=new s(e.getConfig(),t||{},n);v(),function(e){var t=e.getAdRules(),i=0===t.frequency&&1===c,r=c>=t.startOn&&(c-t.startOn)%t.frequency==0;return i||r}(a)?a.getSchedule()&&((f=new y(n,a,e,u,r)).init(),f.on("all",(function(t,i){return e.trigger(t,i)})),e.once("beforePlay",(function(e){return f.beforePlay(e)}),f).on("resize",(function(e){var t=e.width,i=e.height;return f.resize(t,i)}),f).on("fullscreen",(function(){return f.resize()}),f).on("all",g,f)):a.adschedule=null}function g(e,t){"time"===e?f.time(t):"beforeComplete"===e&&f.beforeComplete()}r.extend(this,e.Events),this.version="2.2.17",e.pauseAd=function(e,t){f&&(e?f.pause(t||{}):f.resume(t||{}))},e.skipAd=function(){f&&f.adSkip()},e.on("ready",(function(){o().catch((function(){E("Ad playback blocked by an ad blocker",2e4)})),w.catch((function(e){E("Ad Error: "+e.message,60002)}))}),this).on("playlistItem",(function(e){c++,m(e,e.item.streamtype||n.streamtype)}),this).on("playlistComplete",(function(){v()}),this).on("cast",(function(e){e.active&&v()}),this).on("destroyPlugin",(function(){i.destroy()}),this);var E=function(t,n){p(),e.off(null,null,i),e.playAd=r.noop,e.trigger("adError",{id:"-1",client:"freewheel",message:t,code:900,adErrorCode:n,tag:""})},w=function(e,t,i){var r=l[t];return r||(l[t]=new Promise((function(r,n){!function(i){var r=new e.key(t);if("unlimited"===r.edition())return i();var n=["//","entitlements.jwplayer.com","/",r.token(),".json"];"file:"===window.location.protocol&&n.unshift("https:"),e.ajax(n.join(""),(function(e){i(e&&e.response)}),(function(){i()}),{timeout:1e4,responseType:"json"})}((function(e){var t,s,a=e||{};!0===i.outstream?(t=!1!==a.canPlayOutstreamAds,s="Outstream Ad Limit Reached"):(t=!1!==a.canPlayAds,s="Ad Limit Reached"),!1!==t?r({message:"Can Play Ads"}):n({message:s})}))})))}(r,a,t);w.catch(r.noop),this.destroy=p,this.stopAd=function(){f&&f.stopAd()}}))}();
